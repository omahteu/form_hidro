<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exibir Registros</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1>Registros</h1>
        <div id="records"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            fetch('./src/php/read.php')
                .then(response => response.json())
                .then(data => {
                    const recordsDiv = document.getElementById('records');

                    if (data.records && data.records.length > 0) {
                        data.records.forEach(record => {
                            const recordDiv = document.createElement('div');
                            recordDiv.className = 'record';

                            const os = document.createElement('p');
                            os.textContent = `N° Ordem de Serviço: ${record.os}`;
                            recordDiv.appendChild(os);

                            const codigo = document.createElement('p');
                            codigo.textContent = `Código Ligação: ${record.codigo}`;
                            recordDiv.appendChild(codigo);

                            ['testada', 'hretirado', 'hnovo', 'cavalete'].forEach(field => {
                                if (record[field]) {
                                    const img = document.createElement('img');
                                    img.src = `data:image/png;base64,${record[field]}`;
                                    img.alt = field;
                                    img.className = 'img-thumbnail';
                                    img.style = 'max-width: 200px; margin: 10px;';
                                    recordDiv.appendChild(img);
                                }
                            });

                            recordsDiv.appendChild(recordDiv);
                        });
                    } else {
                        recordsDiv.textContent = "Nenhum registro encontrado.";
                    }
                })
                .catch(error => {
                    console.error('Erro ao buscar registros:', error);
                });
        });
    </script>
</body>
</html>
